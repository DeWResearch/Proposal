"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t,e,r,n,i,o,s,a=require("@ethersproject/providers"),u=require("@aragon/sdk-ipfs"),c=require("graphql-request"),l=require("@ethersproject/address"),p=require("@ethersproject/abi"),f=require("@ethersproject/hash"),h=require("@aragon/osx-ethers"),d=require("@ethersproject/keccak256"),g=require("@ethersproject/strings"),v=require("@ethersproject/bytes"),w=require("@ethersproject/constants"),x=require("@aragon/osx-commons-configs"),m=require("@ethersproject/contracts"),y=require("yup");function E(t){var e,r;function n(e,r){try{var o=t[e](r),s=o.value,a=s instanceof I;Promise.resolve(a?s.v:s).then((function(r){if(a){var u="return"===e?"return":"next";if(!s.k||r.done)return n(u,r);r=t[u](r).value}i(o.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){i("throw",t)}}function i(t,i){switch(t){case"return":e.resolve({value:i,done:!0});break;case"throw":e.reject(i);break;default:e.resolve({value:i,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,i){return new Promise((function(o,s){var a={key:t,arg:i,resolve:o,reject:s,next:null};r?r=r.next=a:(e=r=a,n(t,i))}))},"function"!=typeof t.return&&(this.return=void 0)}function I(t,e){this.v=t,this.k=e}function b(t){return new I(t,0)}function S(){S=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=Object.create((e&&e.prototype instanceof w?e:w).prototype),s=new k(n||[]);return i(o,"_invoke",{value:R(t,r,s)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",g="completed",v={};function w(){}function x(){}function m(){}var y={};c(y,s,(function(){return this}));var E=Object.getPrototypeOf,I=E&&E(E(T([])));I&&I!==r&&n.call(I,s)&&(y=I);var b=m.prototype=w.prototype=Object.create(y);function P(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function A(t,e){function r(i,o,s,a){var u=p(t[i],t,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,s,a)}),(function(t){r("throw",t,s,a)})):e.resolve(l).then((function(t){c.value=t,s(c)}),(function(t){return r("throw",t,s,a)}))}a(u.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function R(e,r,n){var i=f;return function(o,s){if(i===d)throw new Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var u=N(a,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=d;var c=p(e,r,n);if("normal"===c.type){if(i=n.done?g:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=g,n.method="throw",n.arg=c.arg)}}}function N(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,N(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=p(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(typeof e+" is not iterable")}return x.prototype=m,i(b,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:x,configurable:!0}),x.displayName=c(m,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,c(t,u,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},P(A.prototype),c(A.prototype,a,(function(){return this})),e.AsyncIterator=A,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new A(l(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(b),c(b,u,"Generator"),c(b,s,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;_(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function P(t){return function(){return new E(t.apply(this,arguments))}}function A(t,e,r,n,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,i)}function R(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function s(t){A(o,n,i,s,a,"next",t)}function a(t){A(o,n,i,s,a,"throw",t)}s(void 0)}))}}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,"symbol"==typeof(i=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key))?i:String(i),n)}var i}function O(t,e,r){return e&&N(t.prototype,e),r&&N(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _(){return _=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_.apply(this,arguments)}function k(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,C(t,e)}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function C(t,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},C(t,e)}function F(t,e,r){return F=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct.bind():function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&C(i,r.prototype),i},F.apply(null,arguments)}function M(t){var e="function"==typeof Map?new Map:void 0;return M=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return F(t,arguments,T(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),C(r,t)},M(t)}function q(t,e){return e||(e=t.slice(0)),t.raw=e,t}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function D(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return U(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?U(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}E.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},E.prototype.next=function(t){return this._invoke("next",t)},E.prototype.throw=function(t){return this._invoke("throw",t)},E.prototype.return=function(t){return this._invoke("return",t)},exports.PrepareInstallationStep=void 0,(t=exports.PrepareInstallationStep||(exports.PrepareInstallationStep={})).PREPARING="preparing",t.DONE="done",exports.PrepareUninstallationSteps=void 0,(e=exports.PrepareUninstallationSteps||(exports.PrepareUninstallationSteps={})).PREPARING="preparing",e.DONE="done",exports.PermissionOperationType=void 0,(r=exports.PermissionOperationType||(exports.PermissionOperationType={}))[r.GRANT=0]="GRANT",r[r.REVOKE=1]="REVOKE",r[r.GRANT_WITH_CONDITION=2]="GRANT_WITH_CONDITION",exports.SortDirection=void 0,(n=exports.SortDirection||(exports.SortDirection={})).ASC="asc",n.DESC="desc",exports.TokenType=void 0,(i=exports.TokenType||(exports.TokenType={})).NATIVE="native",i.ERC20="erc20",i.ERC721="erc721",i.ERC1155="erc1155",exports.ProposalStatus=void 0,(o=exports.ProposalStatus||(exports.ProposalStatus={})).ACTIVE="Active",o.PENDING="Pending",o.SUCCEEDED="Succeeded",o.EXECUTED="Executed",o.DEFEATED="Defeated",exports.PrepareUpdateStep=void 0,(s=exports.PrepareUpdateStep||(exports.PrepareUpdateStep={})).PREPARING="preparing",s.DONE="done";var G={prod:[{url:"https://prod.ipfs.aragon.network/api/v0",headers:{"X-API-KEY":"b477RhECf8s8sdM7XrkLBs2wHc4kCMwpbcFC55Kt"}}],test:[{url:"https://test.ipfs.aragon.network/api/v0",headers:{"X-API-KEY":"b477RhECf8s8sdM7XrkLBs2wHc4kCMwpbcFC55Kt"}}]},L={UPGRADE_PERMISSION:"UPGRADE_PERMISSION",UPGRADE_PLUGIN_PERMISSION:"UPGRADE_PLUGIN_PERMISSION",SET_METADATA_PERMISSION:"SET_METADATA_PERMISSION",EXECUTE_PERMISSION:"EXECUTE_PERMISSION",WITHDRAW_PERMISSION:"WITHDRAW_PERMISSION",SET_SIGNATURE_VALIDATOR_PERMISSION:"SET_SIGNATURE_VALIDATOR_PERMISSION",SET_TRUSTED_FORWARDER_PERMISSION:"SET_TRUSTED_FORWARDER_PERMISSION",ROOT_PERMISSION:"ROOT_PERMISSION",CREATE_VERSION_PERMISSION:"CREATE_VERSION_PERMISSION",REGISTER_PERMISSION:"REGISTER_PERMISSION",REGISTER_DAO_PERMISSION:"REGISTER_DAO_PERMISSION",REGISTER_ENS_SUBDOMAIN_PERMISSION:"REGISTER_ENS_SUBDOMAIN_PERMISSION",MINT_PERMISSION:"MINT_PERMISSION",MERKLE_MINT_PERMISSION:"MERKLE_MINT_PERMISSION",MODIFY_ALLOWLIST_PERMISSION:"MODIFY_ALLOWLIST_PERMISSION",SET_CONFIGURATION_PERMISSION:"SET_CONFIGURATION_PERMISSION"},j=Object.entries(L).reduce((function(t,e){var r;return _({},t,((r={})[e[0]+"_ID"]=d.keccak256(g.toUtf8Bytes(e[1])),r))}),{});Object.freeze(L),Object.freeze(j);var B,V,W,H=/^((Qm[1-9A-HJ-NP-Za-km-z]{44,})|(b[A-Za-z2-7]{58,}|B[A-Z2-7]{58,})|(z[1-9A-HJ-NP-Za-km-z]{48,})|(F[0-9A-F]{50,}))$/,z=/^ipfs:\/\/((Qm[1-9A-HJ-NP-Za-km-z]{44,})|(b[A-Za-z2-7]{58,}|B[A-Z2-7]{58,})|(z[1-9A-HJ-NP-Za-km-z]{48,})|(F[0-9A-F]{50,}))$/,X=/^(0x[A-Fa-f0-9]{40})_(0x[A-Fa-f0-9]{1,64})$/,$=/^(0x)?[0-9a-fA-F]*$/,K=/^(?:[a-z0-9-]+\.)*[a-z0-9-]+\.eth$/,Z=/^[a-z0-9-]+$/,Y=c.gql(B||(B=q(["\n{\n  _meta{\n    deployment\n  }\n}\n"]))),J=c.gql(V||(V=q(["\nquery IPlugin($address: ID!, $where: IPlugin_filter!) {\n\tiplugin(id:$address, where:$where) {\n    installations(where:{state: Installed}) {\n      appliedPreparation {\n        helpers\n        pluginRepo {\n          id\n        }\n      }\n     \tappliedVersion {\n        metadata\n        build\n        release {\n          release\n        }\n      }\n    }   \n  }\n}\n"]))),Q=function(t){function e(e,r){var n;return(n=t.call(this,e)||this).cause=void 0,"string"==typeof r?n.cause=r:r instanceof Error&&(n.cause=r.message),n}return k(e,t),e}(M(Error)),tt=function(t){function e(e,r){return t.call(this,e||"Time out",r)||this}return k(e,t),e}(Q),et=function(t){function e(e,r){return t.call(this,"Unsupported protocol: "+e,r)||this}return k(e,t),e}(Q),rt=function(t){function e(e,r){return t.call(this,"Cannot fetch the "+e+" data from GraphQL",r)||this}return k(e,t),e}(Q),nt=function(t){function e(e){return t.call(this,"Cannot add or get data from ipfs",e)||this}return k(e,t),e}(Q),it=function(t){function e(e){return t.call(this,"Invalid address or ENS",e)||this}return k(e,t),e}(Q),ot=function(t){function e(e){return t.call(this,"Invalid address",e)||this}return k(e,t),e}(Q),st=function(t){function e(e){return t.call(this,"The value does not contain a valid CiD",e)||this}return k(e,t),e}(Q),at=function(t){function e(e){return t.call(this,"Invalid proposal ID",e)||this}return k(e,t),e}(Q),ut=function(t){function e(e){return t.call(this,"A web3 provider is needed",e)||this}return k(e,t),e}(Q),ct=function(t){function e(e){return t.call(this,"A signer is needed",e)||this}return k(e,t),e}(Q),lt=function(t){function e(e){return t.call(this,"The received action is different from the expected one",e)||this}return k(e,t),e}(Q),pt=function(t){function e(e){return t.call(this,"A token address is needed",e)||this}return k(e,t),e}(Q),ft=function(t){function e(e){return t.call(this,"A dao factory address is needed",e)||this}return k(e,t),e}(Q),ht=function(t){function e(e){return t.call(this,"A plugin repo registry address is needed",e)||this}return k(e,t),e}(Q),dt=function(t){function e(e){return t.call(this,"A dao registry address is needed",e)||this}return k(e,t),e}(Q),gt=function(t){function e(e){return t.call(this,"Failed to pin data on IPFS",e)||this}return k(e,t),e}(Q),vt=function(t){function e(e){return t.call(this,"Failed to create proposal",e)||this}return k(e,t),e}(Q),wt=function(t){function e(e){return t.call(this,"Failed to create DAO",e)||this}return k(e,t),e}(Q),xt=function(t){function e(e){return t.call(this,"No plugin requests EXECUTE_PERMISSION",e)||this}return k(e,t),e}(Q),mt=function(t){function e(e){return t.call(this,"Failed to fetch data from IPFS",e)||this}return k(e,t),e}(Q),yt=function(t){function e(e){return t.call(this,"Invalid voting mode",e)||this}return k(e,t),e}(Q),Et=function(t){function e(e){return t.call(this,"Could not define a minimum allowance",e)||this}return k(e,t),e}(Q),It=function(t){function e(e){return t.call(this,"Invalid precision, number must be an integer greater than 0",e)||this}return k(e,t),e}(Q),bt=function(t){function e(e){return t.call(this,"Failed to deposit",e)||this}return k(e,t),e}(Q),St=function(t){function e(e,r,n){return t.call(this,"Deposited amount mismatch. Expected: "+e+", received: "+r,n)||this}return k(e,t),e}(Q),Pt=function(t){function e(e,r){return t.call(this,"Unsupported network: "+e,r)||this}return k(e,t),e}(Q),At=function(t){function e(e,r){return t.call(this,e+" client is not initialized",r)||this}return k(e,t),e}(Q),Rt=function(t){function e(e,r){return t.call(this,"No "+e+" nodes available",r)||this}return k(e,t),e}(Q),Nt=function(t){function e(e){return t.call(this,"Failed to install plugin",e)||this}return k(e,t),e}(Q),Ot=function(t){function e(e,r){return t.call(this,"Cannot decode data: "+e,r)||this}return k(e,t),e}(Q),_t=function(t){function e(e){return t.call(this,"Invalid contract address",e)||this}return k(e,t),e}(Q),kt=function(t){function e(e){return t.call(this,"Invalid contract ABI",e)||this}return k(e,t),e}(Q),Tt=function(t){function e(e){return t.call(this,"Cannot estimate gas error",e)||this}return k(e,t),e}(Q),Ct=function(t){function e(e){return t.call(this,"Installation not found",e)||this}return k(e,t),e}(Q),Ft=function(t){function e(e){return t.call(this,"plugin uninstallation error",e)||this}return k(e,t),e}(Q),Mt=function(t){function e(e){return t.call(this,"Missing metadata",e)||this}return k(e,t),e}(Q),qt=function(t){function e(e){return t.call(this,"Invalid prepare uninstallation ABI",e)||this}return k(e,t),e}(Q),Ut=function(t){function e(e){return t.call(this,"Invalid subdomain format: use a-z, 0-9 and -",e)||this}return k(e,t),e}(Q),Dt=function(t){function e(e){return t.call(this,"Please, use the token's transfer function directly",e)||this}return k(e,t),e}(Q),Gt=function(t){function e(e){return t.call(this,"invalid actions, the types or order of the actions may cause the execution to fail",e)||this}return k(e,t),e}(Q),Lt=function(t){function e(e,r,n){return t.call(this,"Size mismatch: "+e+" and "+r+" should match",n)||this}return k(e,t),e}(Q),jt=function(t){function e(e){return t.call(this,"Invalid proposal status",e)||this}return k(e,t),e}(Q),Bt=function(t){function e(e,r){return t.call(this,"Not implemented: "+e,r)||this}return k(e,t),e}(Q),Vt=function(t){function e(e){return t.call(this,"The received action is not recognized",e)||this}return k(e,t),e}(Q),Wt=function(t){function e(e){return t.call(this,"Invalid subdomain format: use a-z, 0-9 and -",e)||this}return k(e,t),e}(Q),Ht=function(t){function e(e){return t.call(this,"Gas estimation factor value should be a number between 0 and 1",e)||this}return k(e,t),e}(Q),zt=function(t){function e(e,r){return t.call(this,"Invalid parameter:"+e,r)||this}return k(e,t),e}(Q),Xt=function(t){function e(e){return t.call(this,"The provided address does not point to a contract",e)||this}return k(e,t),e}(Q),$t=function(t){function e(e){return t.call(this,"The new version and the current version should have the same release number and the new build number should be greater than the current build number",e)||this}return k(e,t),e}(Q),Kt=function(t){function e(e){return t.call(this,"Failed to prepare plugin update",e)||this}return k(e,t),e}(Q),Zt=function(t){function e(e){return t.call(this,"Proposal not found",e)||this}return k(e,t),e}(Q),Yt=function(t){function e(e,r){return t.call(this,"Invalid array size: "+e,r)||this}return k(e,t),e}(Q),Jt=function(t){function e(e,r){return t.call(this,"The ratio value should range between 0 and 1, received value: "+e,r)||this}return k(e,t),e}(Q),Qt=function(t){function e(e,r){return t.call(this,"The number of digits should range between 1 and 15, received value: "+e,r)||this}return k(e,t),e}(Q),te=function(t){function e(e){return t.call(this,"The value is out of range",e)||this}return k(e,t),e}(Q),ee=function(t){function e(e){return t.call(this,"The bitmap value is too big",e)||this}return k(e,t),e}(Q),re=function(t){function e(e){return t.call(this,"The multi URI is empty",e)||this}return k(e,t),e}(Q),ne=function(t){function e(e){return t.call(this,"Invalid promise",e)||this}return k(e,t),e}(Q),ie=function(t){function e(e){return t.call(this,"Invalid timeout",e)||this}return k(e,t),e}(Q),oe=function(t){function e(e){return t.call(this,"Invalid permission operation",e)||this}return k(e,t),e}(Q),se=function(t){function e(e,r,n,i){return t.call(this,'Contract "'+e+'" version "'+r+'" is not deployed on network "'+n+'"',i)||this}return k(e,t),e}(Q),ae=function(){function t(t){if(this.items=[],!t)throw new re;this.items=t.split(",")}return O(t,[{key:"ipfsCid",get:function(){for(var t,e=D(this.items);!(t=e()).done;){var r=t.value;if(H.test(r))return r;r.startsWith("ipfs://")&&(r=r.substring(7));var n=r.indexOf("/"),i=n<0?r:r.substring(0,n);if(H.test(i))return i}return null}},{key:"ipfs",get:function(){for(var t,e=D(this.items);!(t=e()).done;){var r=t.value;if(H.test(r))return{cid:r,path:""};r.startsWith("ipfs://")&&(r=r.substring(7));var n=r.indexOf("/"),i=r;if(n<0){if(!H.test(i))continue;return{cid:i,path:""}}if(i=r.substring(0,n),H.test(i)){var o=r.indexOf("?");return o<0&&(o=r.indexOf("#")),o<0?{cid:i,path:r.substring(n)}:{cid:i,path:r.substring(n,o)}}}return null}},{key:"http",get:function(){return this.items.filter((function(t){return t.startsWith("http://")||t.startsWith("https://")}))}}]),t}();function ue(t){return new RegExp(X).test(t)}function ce(t){return new RegExp(K).test(t)}function le(t){return new RegExp(z).test(t)}function pe(t){return new RegExp(Z).test(t)}function fe(t){return t.startsWith("0x")?t:"0x"+t}function he(t){return t.startsWith("0x")?t.substring(2):t}function de(t){if(!t)return new Uint8Array;if(!$.test(t))throw new Error("Invalid hex string");if(t.length%2!=0)throw new Error("The hex string has an odd length");t=he(t);for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substring(r,r+2),16));return Uint8Array.from(e)}function ge(t,e){for(var r=[],n=0;n<t.length;n++)r.push(t[n]>=16?t[n].toString(16):"0"+t[n].toString(16));return e?r.join(""):fe(r.join(""))}function ve(t,e,r){return t.logs.find((function(t){return t.topics[0]===f.id(e.getEvent(r).format("sighash"))}))}function we(t){return void 0===t&&(t=[]),t.map((function(t){if(t.type.startsWith("tuple")){var e="tuple("+we(t.components).join(", ")+")";return t.type.endsWith("[]")&&(e=e.concat("[]")),e}return t.type.endsWith("[]")?t.type.slice(0,-2)+"[] "+t.name:t.type+" "+t.name}))}function xe(){return(xe=R(S().mark((function t(e,r){var n,i,o,s,a,u,c,f,d,g,v,w,m;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.getProvider(),l.isAddress(r.pluginRepo)){t.next=3;break}throw new ot;case 3:return t.next=5,i.getNetwork();case 5:if(s=null==(n=x.getNetworkByNameOrAlias(o=t.sent.name))?void 0:n.name){t.next=9;break}throw new Pt(o);case 9:if(a=r.version){t.next=19;break}return u=h.PluginRepo__factory.connect(r.pluginRepo,i),t.next=14,u.latestRelease();case 14:return c=t.sent,t.next=17,u["getLatestVersion(uint8)"](c);case 17:a=t.sent.tag;case 19:if(d=void 0===(f=r.installationParams)?[]:f,v=p.defaultAbiCoder.encode(we(void 0===(g=r.installationAbi)?[]:g),d),w=x.getNetworkDeploymentForVersion(s,x.SupportedVersions.V1_3_0)){t.next=24;break}throw new Pt(s);case 24:return m=h.PluginSetupProcessor__factory.connect(w[x.FrameworkContractsNames.PLUGIN_SETUP_PROCESSOR].address,i),t.next=27,m.estimateGas.prepareInstallation(r.daoAddressOrEns,{pluginSetupRef:{pluginSetupRepo:r.pluginRepo,versionTag:a},data:v});case 27:return t.abrupt("return",e.getApproximateGasFee(t.sent.toBigInt()));case 29:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function me(){return(me=P(S().mark((function t(e,r){var n,i,o,s,a,u,c,f,d,g,v,w,x,m,y,E;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.getConnectedSigner(),l.isAddress(r.pluginRepo)){t.next=3;break}throw new ot;case 3:if(i=r.version){t.next=13;break}return o=h.PluginRepo__factory.connect(r.pluginRepo,n),t.next=8,b(o.latestRelease());case 8:return s=t.sent,t.next=11,b(o["getLatestVersion(uint8)"](s));case 11:i=t.sent.tag;case 13:return u=void 0===(a=r.installationParams)?[]:a,f=p.defaultAbiCoder.encode(we(void 0===(c=r.installationAbi)?[]:c),u),d=h.PluginSetupProcessor__factory.connect(r.pluginSetupProcessorAddress,n),t.next=18,b(d.prepareInstallation(r.daoAddressOrEns,{pluginSetupRef:{pluginSetupRepo:r.pluginRepo,versionTag:i},data:f}));case 18:return g=t.sent,t.next=21,{key:exports.PrepareInstallationStep.PREPARING,txHash:g.hash};case 21:return t.next=23,b(g.wait());case 23:if(v=t.sent,w=h.PluginSetupProcessor__factory.createInterface(),x=ve(v,w,"InstallationPrepared")){t.next=28;break}throw new Nt;case 28:if(m=w.parseLog(x),E=m.args.preparedSetupData,(y=m.args.plugin)||E){t.next=33;break}throw new Nt;case 33:return t.next=35,{key:exports.PrepareInstallationStep.DONE,pluginAddress:y,pluginRepo:r.pluginRepo,versionTag:i,permissions:E.permissions,helpers:E.helpers};case 35:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ye(t,e){return Ee.apply(this,arguments)}function Ee(){return(Ee=R(S().mark((function t(e,r){var n,i,o,s,a,u;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.request({query:J,params:{address:r.pluginAddress.toLowerCase(),where:{dao:r.daoAddressOrEns.toLowerCase()}},name:"plugin"});case 2:if(i=t.sent.iplugin.installations[void 0===(n=r.pluginInstallationIndex)?0:n]){t.next=8;break}throw new Ct;case 8:if(!(r.newVersion.release!==i.appliedVersion.release.release||r.newVersion.build<=i.appliedVersion.build)){t.next=10;break}throw new $t;case 10:return s=void 0===(o=r.updateParams)?[]:o,u=p.defaultAbiCoder.encode(we(void 0===(a=r.updateAbi)?[]:a),s),t.abrupt("return",{currentVersionTag:{build:i.appliedVersion.build,release:i.appliedVersion.release.release},newVersionTag:r.newVersion,pluginSetupRepo:r.pluginRepo,setupPayload:{plugin:r.pluginAddress,currentHelpers:i.appliedPreparation.helpers,data:u}});case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ie(){return(Ie=R(S().mark((function t(e,r,n){var i,o,s;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.getConnectedSigner(),t.next=3,ye(r,n);case 3:return o=t.sent,s=h.PluginSetupProcessor__factory.connect(n.pluginSetupProcessorAddress,i),t.next=7,s.estimateGas.prepareUpdate(n.daoAddressOrEns,o);case 7:return t.abrupt("return",e.getApproximateGasFee(t.sent.toBigInt()));case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function be(){return(be=P(S().mark((function t(e,r,n){var i,o,s,a,u,c,l,p,f,d,g;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.getConnectedSigner(),t.next=3,b(ye(r,n));case 3:return o=t.sent,s=h.PluginSetupProcessor__factory.connect(n.pluginSetupProcessorAddress,i),t.next=7,b(s.prepareUpdate(n.daoAddressOrEns,o));case 7:return a=t.sent,t.next=10,{key:exports.PrepareUpdateStep.PREPARING,txHash:a.hash};case 10:return t.next=12,b(a.wait());case 12:if(u=t.sent,c=h.PluginSetupProcessor__factory.createInterface(),l=ve(u,c,"UpdatePrepared")){t.next=17;break}throw new Kt;case 17:if(p=c.parseLog(l),d=p.args.preparedSetupData,g=p.args.initData,(f=p.args.versionTag)&&f.build===n.newVersion.build&&f.release===n.newVersion.release&&d&&g){t.next=23;break}throw new Kt;case 23:return t.next=25,{key:exports.PrepareUpdateStep.DONE,versionTag:f,pluginRepo:n.pluginRepo,pluginAddress:n.pluginAddress,initData:de(g),permissions:d.permissions,helpers:d.helpers};case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Se(t){var e=null;try{e=a.getNetwork(t)}catch(t){}try{e=function(t){var e=null,r=null;switch(typeof t){case"string":case"number":var n;if(!(e="number"==typeof t?x.getNetworkByChainId(t):x.getNetworkByNameOrAlias(t)))throw new Pt(t.toString());var i=x.getNetworkAlias(x.SupportedAliases.ETHERS_5,e.name),o=x.getNetworkDeploymentForVersion(e.name,x.SupportedVersions.V1_3_0);if(!o)throw new Pt(e.name);var s=null==(n=o.ENSRegistry)?void 0:n.address;r={name:i||e.name,chainId:e.chainId,ensAddress:s};break;case"object":t.name&&t.chainId&&(r=t);break;default:throw new Pt(t)}return r}(t)}catch(t){}if(!e)throw new Pt(t.toString());return e}function Pe(t){return x.networks[t].isTestnet?G.test:G.prod}function Ae(t){return[{url:"https://subgraph.satsuma-prod.com/qHR2wGfc5RLi6/aragon/osx-"+t+"/version/v1.4.0/api"}]}var Re=["https:"],Ne=[].concat(Object.values(x.FrameworkContractsNames),Object.values(x.NonFrameworkContractsNames));"undefined"!=typeof process&&null!=(W=process)&&null!=(W=W.env)&&W.TESTING&&Re.push("http:");var Oe=function(){function t(t){this.state={},this.overriden=Ne.reduce((function(t,e){var r;return _({},t,((r={})[e]=!1,r))}),{ENSRegistry:!1});var e=Object.assign({network:"mainnet"},t);this.set(e)}var e=t.prototype;return e.set=function(e){var r,n;e.network&&(this.state.network=t.resolveNetwork(e.network,e.ENSRegistry),this.setNetworkDefaults()),e.signer&&(this.state.signer=e.signer),(e.web3Providers||Array.isArray(e.web3Providers)&&e.web3Providers.length)&&(this.state.web3Providers=t.resolveWeb3Providers(e.web3Providers,this.state.network)),null!=(r=e.graphqlNodes)&&r.length&&(this.state.graphql=t.resolveGraphql(e.graphqlNodes),this.overriden.graphqlNodes=!0),null!=(n=e.ipfsNodes)&&n.length&&(this.state.ipfs=t.resolveIpfs(e.ipfsNodes),this.overriden.ipfsNodes=!0);for(var i,o=D(Ne);!(i=o()).done;){var s=i.value;e[s]&&(this.state[s]=e[s],this.overriden[s]=!0)}e.gasFeeEstimationFactor&&(this.state.gasFeeEstimationFactor=t.resolveGasFeeEstimationFactor(e.gasFeeEstimationFactor),this.overriden.gasFeeEstimationFactor=!0)},e.setNetworkDefaults=function(){var e=x.getNetworkNameByAlias(this.network.name);if(!e)throw new Pt(this.network.name);this.overriden.graphqlNodes||(this.state.graphql=t.resolveGraphql(Ae(e))),this.overriden.ipfsNodes||(this.state.ipfs=t.resolveIpfs(Pe(e)));for(var r,n=D(Ne);!(r=n()).done;){var i=r.value;if(!this.overriden[i]){var o,s=void 0,a=x.getNetworkDeploymentForVersion(e,x.SupportedVersions.V1_3_0);a&&(s=null==(o=a[i])?void 0:o.address),i!==x.NonFrameworkContractsNames.ENS_REGISTRY||s||(s=this.network.ensAddress),s&&(this.state[i]=s)}}this.overriden.gasFeeEstimationFactor||(this.state.gasFeeEstimationFactor=.625)},e.getAddress=function(t){return this.state[t]},t.resolveNetwork=function(t,e){var r=Se(t);if(e){if(!l.isAddress(e))throw new ot;r.ensAddress=e}return r},t.resolveWeb3Providers=function(t,e){if(Array.isArray(t))return t.map((function(t){if("string"==typeof t){var r=new URL(t);if(!Re.includes(r.protocol))throw new et(r.protocol);return new a.JsonRpcProvider(r.href,e)}return t}));if("string"==typeof t){var r=new URL(t);if(!Re.includes(r.protocol))throw new et(r.protocol);return[new a.JsonRpcProvider(r.href,e)]}return[t]},t.resolveIpfs=function(t){var e=[];return t.forEach((function(t){var r=new URL(t.url);if(!Re.includes(r.protocol))throw new et(r.protocol);e.push(new u.Client(r,t.headers))})),e},t.resolveGraphql=function(t){var e=[];return t.forEach((function(t){var r=new URL(t.url);if(!Re.includes(r.protocol))throw new et(r.protocol);e.push(new c.GraphQLClient(r.href))})),e},t.resolveGasFeeEstimationFactor=function(t){if(t<0||t>1)throw new Ht;return t},O(t,[{key:"network",get:function(){return this.state.network}},{key:"signer",get:function(){return this.state.signer}},{key:"web3Providers",get:function(){return this.state.web3Providers||[]}},{key:"gasFeeEstimationFactor",get:function(){return this.state.gasFeeEstimationFactor}},{key:"ipfs",get:function(){return this.state.ipfs}},{key:"graphql",get:function(){return this.state.graphql}}]),t}();function _e(t){return ke.apply(this,arguments)}function ke(){return(ke=R(S().mark((function t(e){var r,n,i,o;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.func,n=e.onFail,i=e.shouldRetry;case 1:return t.prev=1,t.next=4,r();case 4:return t.abrupt("return",t.sent);case 8:t.prev=8,t.t0=t.catch(1),o=t.t0,"function"==typeof n&&n(t.t0);case 12:if(i()){t.next=1;break}case 13:throw o;case 14:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}var Te=function(){function t(t){var e;this.clientIdx=-1,this.clients=[],null!=(e=t.graphql)&&e.length&&(this.clients=t.graphql,this.clientIdx=Math.floor(Math.random()*t.graphql.length))}var e=t.prototype;return e.getClient=function(){if(!this.clients.length||!this.clients[this.clientIdx])throw new At("graphql");return this.clients[this.clientIdx]},e.shiftClient=function(){if(!this.clients.length)throw new At("graphql");if(this.clients.length<2)throw new Rt("graphql");this.clientIdx=(this.clientIdx+1)%this.clients.length},e.isUp=function(){return this.getClient().request(Y).then((function(t){var e;return!(null==(e=t._meta)||!e.deployment)})).catch((function(){return!1}))},e.ensureOnline=function(){var t=R(S().mark((function t(){var e;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.clients.length){t.next=2;break}throw new At("graphql");case 2:e=0;case 3:if(!(e<this.clients.length)){t.next=12;break}return t.next=6,this.isUp();case 6:if(!t.sent){t.next=8;break}return t.abrupt("return");case 8:this.shiftClient();case 9:e++,t.next=3;break;case 12:throw new Rt("graphql");case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.request=function(t){var e=this,r=t.query,n=t.params,i=t.name;if(!this.clients.length)throw new At("graphql");var o=this.clients.length;return _e({func:function(){return e.getClient().request(r,n)},onFail:function(t){if(t instanceof c.ClientError&&t.response.status<500)throw new rt(i||"",t);o--,e.shiftClient()},shouldRetry:function(){return o>0}})},t}(),Ce=function(){function t(t){var e;this.clientIdx=-1,this.clients=[],null!=(e=t.ipfs)&&e.length&&(this.clients=t.ipfs,this.clientIdx=Math.floor(Math.random()*t.ipfs.length))}var e=t.prototype;return e.getClient=function(){if(!this.clients.length||!this.clients[this.clientIdx])throw new At("ipfs");return this.clients[this.clientIdx]},e.shiftClient=function(){var t;if(!this.clients.length)throw new At("ipfs");if((null==(t=this.clients)?void 0:t.length)<2)throw new Rt("ipfs");this.clientIdx=(this.clientIdx+1)%this.clients.length},e.isUp=function(){var t;return null!=(t=this.clients)&&t.length?this.getClient().nodeInfo().then((function(){return!0})).catch((function(){return!1})):Promise.resolve(!1)},e.ensureOnline=function(){var t=R(S().mark((function t(){var e,r;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.clients.length){t.next=2;break}throw new At("ipfs");case 2:e=0;case 3:if(!(e<(null==(r=this.clients)?void 0:r.length))){t.next=12;break}return t.next=6,this.isUp();case 6:if(!t.sent){t.next=8;break}return t.abrupt("return");case 8:this.shiftClient();case 9:e++,t.next=3;break;case 12:throw new Rt("ipfs");case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.getOnlineClient=function(){var t=this;return this.ensureOnline().then((function(){return t.getClient()}))},e.add=function(){var t=R(S().mark((function t(e){var r=this;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.runAndRetryHelper((function(){return r.getClient().add(e)})).then((function(t){return t.hash})));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.pin=function(t){var e=this;return this.runAndRetryHelper((function(){return e.getClient().pin(t)}))},e.fetchBytes=function(t){var e=this;return this.runAndRetryHelper((function(){return e.getClient().cat(t)}))},e.runAndRetryHelper=function(t){var e=this;if(!this.clients.length)throw new At("ipfs");var r=this.clients.length;return _e({func:t,onFail:function(t){if(t instanceof u.ClientError&&t.response.status<500)throw new nt(t);r--,e.shiftClient()},shouldRetry:function(){return r>0}})},e.fetchString=function(t){return this.fetchBytes(t).then((function(t){return(new TextDecoder).decode(t)})).catch((function(t){throw new Ot(t.message)}))},t}(),Fe=function(){function t(t){this.providerIdx=-1,this.context=void 0,this.context=t,this.providerIdx=Math.floor(Math.random()*t.web3Providers.length)}var e=t.prototype;return e.shiftProvider=function(){if(!this.context.web3Providers.length)throw new ut;if(this.context.web3Providers.length<=1)throw new Rt("web3");this.providerIdx=(this.providerIdx+1)%this.context.web3Providers.length},e.getSigner=function(){if(!this.context.signer)throw new ct;return this.context.signer},e.getProvider=function(){if(!this.context.web3Providers[this.providerIdx])throw new ut;return this.context.web3Providers[this.providerIdx]},e.getNetworkName=function(){var t=x.getNetworkByAlias(this.context.network.name);if(!t)throw new Pt(this.context.network.name);return t.name},e.getConnectedSigner=function(){var t=this.getSigner();if(!t.provider){var e=this.getProvider();t=t.connect(e)}return t},e.isUp=function(){return this.getProvider().getNetwork().then((function(){return!0})).catch((function(){return!1}))},e.ensureOnline=function(){var t=R(S().mark((function t(){var e;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.context.web3Providers.length){t.next=2;break}throw new ut;case 2:e=0;case 3:if(!(e<this.context.web3Providers.length)){t.next=12;break}return t.next=6,this.isUp();case 6:if(!t.sent){t.next=8;break}return t.abrupt("return");case 8:this.shiftProvider();case 9:e++,t.next=3;break;case 12:throw new Rt("web3");case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.attachContract=function(t,e){if(!t||!l.isAddress(t))throw new ot;if(!e)throw new kt;var r=this.getConnectedSigner();return new m.Contract(t,e,r)},e.getMaxFeePerGas=function(){return this.getConnectedSigner().getFeeData().then((function(t){if(!t.maxFeePerGas)throw new Tt;return t.maxFeePerGas.toBigInt()}))},e.getApproximateGasFee=function(e){var r=this;return this.getMaxFeePerGas().then((function(n){var i=e*n;return{average:i*BigInt(Math.trunc(r.context.gasFeeEstimationFactor*t.PRECISION_FACTOR_BASE))/BigInt(t.PRECISION_FACTOR_BASE),max:i}}))},e.getAddress=function(t){var e=this.context.getAddress(t);if(!e||!l.isAddress(e))throw new ot;return e},t}();Fe.PRECISION_FACTOR_BASE=1e3;var Me=function(t){function e(e){return t.call(this,e)||this}return k(e,t),e}(Oe),qe=y.mixed().test("isBigint",new zt("bigint").message,(function(t){return"bigint"==typeof t})),Ue=y.string().notRequired().test("isAddressOrEns",(new it).message,(function(t){return!t||l.isAddress(t)||ce(t)})),De=y.string().notRequired().test("isAddressOrEnsWithoutAny",(new it).message,(function(t){return!t||(l.isAddress(t)||ce(t))&&"0xffffffffffffffffffffffffffffffffffffffff"!==t})),Ge=y.object({build:y.number().moreThan(0).required(),release:y.number().moreThan(0).required()}),Le=y.array().notRequired().test("isValidAbi",(new kt).message,(function(){return!0})),je=y.mixed().test("isUint8Array",new zt("Uint8Array").message,(function(t){return!t||t instanceof Uint8Array})),Be=y.string().test("isIpfsUri",(new st).message,(function(t){return!t||le(t)})),Ve=y.string().test("isSubdomain",(new Wt).message,(function(t){return!t||pe(t)})),We=y.object({skip:y.number().min(0).notRequired(),limit:y.number().min(1).notRequired(),direction:y.string().oneOf(["asc","desc"]).notRequired()}),He=y.object({daoAddressOrEns:Ue.required(),pluginAddress:Ue.required(),pluginInstallationIndex:y.number().notRequired().min(0),uninstallationParams:y.array().notRequired(),uninstallationAbi:Le.notRequired()}),ze=y.object({operation:y.number().required().oneOf([0,1,2]),permissionId:y.string().required(),where:De.required(),who:De.required(),condition:y.string().notRequired()}),Xe=y.object({daoAddressOrEns:Ue.required(),pluginRepo:Ue.required(),version:Ge.notRequired(),installationParams:y.array().notRequired(),installationAbi:Le.notRequired()}),$e=y.object({id:Ue.required(),data:je.required()}),Ke=y.object({pluginAddress:Ue.required(),pluginRepo:Ue.required(),versionTag:Ge.required(),permissions:y.array(ze).required()}),Ze=Ke.concat(y.object({helpers:y.array(Ue).required()})),Ye=y.object({address:Ue.required(),pluginAddress:Ue.required(),blockNumber:y.number().notRequired()});exports.AbiSchema=Le,exports.AddressOrEnsSchema=Ue,exports.AddressOrEnsWithoutAnySchema=De,exports.AlwaysFailingProposalError=Gt,exports.AmountMismatchError=St,exports.ApplyInstallationSchema=Ze,exports.ApplyUninstallationSchema=Ke,exports.BigintSchema=qe,exports.CannotEstimateGasError=Tt,exports.ClientCore=function(t){this.web3=void 0,this.ipfs=void 0,this.graphql=void 0,this.web3=new Fe(t),this.ipfs=new Ce(t),this.graphql=new Te(t)},exports.ClientNotInitializedError=At,exports.Context=Me,exports.ContextCore=Oe,exports.ContractNotDeployedError=se,exports.DaoCreationError=wt,exports.DataDecodingError=Ot,exports.DepositNativeTokenError=Dt,exports.EMPTY_PROPOSAL_METADATA_LINK={title:"(the proposal has no metadata)",summary:"(the current proposal does not have any content defined)",description:"(the current proposal does not have any content defined)",resources:[]},exports.ENS_REGEX=K,exports.EmptyMultiUriError=re,exports.FailedDepositError=bt,exports.GraphQLError=rt,exports.HEX_STRING_REGEX=$,exports.IPFS_CID_REGEX=H,exports.IPFS_ENDPOINTS=G,exports.IPFS_URI_REGEX=z,exports.InstallationNotFoundError=Ct,exports.InvalidActionError=Vt,exports.InvalidAddressError=ot,exports.InvalidAddressOrEnsError=it,exports.InvalidArraySizeError=Yt,exports.InvalidBitMapValueError=ee,exports.InvalidCidError=st,exports.InvalidContractAbiError=kt,exports.InvalidContractAddressError=_t,exports.InvalidDigitsValueError=Qt,exports.InvalidEnsError=Ut,exports.InvalidGasEstimationFactorError=Ht,exports.InvalidParameter=zt,exports.InvalidPermissionOperationType=oe,exports.InvalidPrecisionError=It,exports.InvalidPrepareUninstallationAbiError=qt,exports.InvalidPromiseError=ne,exports.InvalidProposalIdError=at,exports.InvalidProposalStatusError=jt,exports.InvalidRatioValueError=Jt,exports.InvalidSubdomainError=Wt,exports.InvalidTimeoutError=ie,exports.InvalidVersionError=$t,exports.InvalidVotingModeError=yt,exports.IpfsError=nt,exports.IpfsFetchError=mt,exports.IpfsPinError=gt,exports.IpfsUriSchema=Be,exports.IsMemberSchema=Ye,exports.MULTI_FETCH_TIMEOUT=7e3,exports.MissingExecPermissionError=xt,exports.MissingMetadataError=Mt,exports.MultiTargetPermissionSchema=ze,exports.MultiUri=ae,exports.NoDaoFactory=ft,exports.NoDaoRegistry=dt,exports.NoNodesAvailableError=Rt,exports.NoPluginRepoRegistry=ht,exports.NoProviderError=ut,exports.NoSignerError=ct,exports.NoTokenAddress=pt,exports.NotAContractError=Xt,exports.NotImplementedError=Bt,exports.OSX_PROPOSAL_ID_REGEX=X,exports.PaginationSchema=We,exports.PermissionIds=j,exports.Permissions=L,exports.PluginInstallItemSchema=$e,exports.PluginInstallationPreparationError=Nt,exports.PluginUninstallationPreparationError=Ft,exports.PluginUpdatePreparationError=Kt,exports.PrepareInstallationSchema=Xe,exports.PrepareUninstallationSchema=He,exports.ProposalCreationError=vt,exports.ProposalNotFoundError=Zt,exports.SUBDOMAIN_REGEX=Z,exports.SizeMismatchError=Lt,exports.SubdomainSchema=Ve,exports.TimeoutError=tt,exports.UNAVAILABLE_PROPOSAL_METADATA={title:"(unavailable metadata)",summary:"(the proposal metadata is not available)",description:"(the proposal metadata is not available)",resources:[]},exports.UNSUPPORTED_PROPOSAL_METADATA_LINK={title:"(unsupported metadata link)",summary:"(the link to the metadata is not supported)",description:"(the link to the metadata is not supported)",resources:[]},exports.Uint8ArraySchema=je,exports.UnexpectedActionError=lt,exports.UnsupportedNetworkError=Pt,exports.UnsupportedProtocolError=et,exports.UpdateAllowanceError=Et,exports.ValueOutOfRangeError=te,exports.VersionTagSchema=Ge,exports.bitmapToBoolArray=function(t){if(t>=BigInt(1)<<BigInt(256))throw new ee;for(var e=[],r=0;r<256;r++){var n=BigInt(1)<<BigInt(r);e.push((t&n)!=BigInt(0))}return e},exports.boolArrayToBitmap=function(t){if(!t||!t.length)return BigInt(0);if(t.length>256)throw new Yt(t.length);for(var e=BigInt(0),r=0;r<256;r++)t[r]&&(e|=BigInt(1)<<BigInt(r));return e},exports.bytesToHex=ge,exports.decodeProposalId=function(t){if(!ue(t))throw new at;var e=t.match(X)||[];if(3!==e.length)throw new at;return{pluginAddress:e[1],id:parseInt(he(e[2]),16)}},exports.decodeRatio=function(t,e){if(!Number.isInteger(e)||e<1||e>15)throw new Qt(e);if(t>Math.pow(10,e))throw new te;return Number(t)/Math.pow(10,e)},exports.encodeProposalId=function(t,e){if(!/^0x[A-Fa-f0-9]{40}$/.test(t))throw new Error("Invalid address");return t+"_0x"+e.toString(16)},exports.encodeRatio=function(t,e){if(t<0||t>1)throw new Jt(t);if(!Number.isInteger(e)||e<1||e>15)throw new Qt(e);return Math.round(t*Math.pow(10,e))},exports.ensure0x=fe,exports.findLog=ve,exports.getCompactProposalId=function(t){if(!t.match(/^(0x[A-Fa-f0-9]{40})_(0x[A-Fa-f0-9]{1,64})$/))throw new Error("Invalid proposalId");var e=t.split("_");return e[0].toLowerCase()+"_0x"+parseInt(e[1]).toString(16)},exports.getDefaultGraphqlNodes=Ae,exports.getDefaultIpfsNodes=Pe,exports.getExtendedProposalId=function(t){if(!ue(t))throw new at;var e=t.split("_");return e[0].toLowerCase()+"_"+v.hexZeroPad(e[1],32)},exports.getFunctionFragment=function(t,e){var r=ge(t);return new p.Interface(e).getFunction(r.substring(0,10))},exports.getInterfaceId=function(t){for(var e=w.Zero,r=0,n=Object.keys(t.functions);r<n.length;r++)e=e.xor(t.getSighash(n[r]));return e.toHexString()},exports.getNamedTypesFromMetadata=we,exports.getNetwork=Se,exports.hexToBytes=de,exports.isEnsName=ce,exports.isIpfsUri=le,exports.isProposalId=ue,exports.isSubdomain=pe,exports.prepareGenericInstallation=function(t,e){return me.apply(this,arguments)},exports.prepareGenericInstallationEstimation=function(t,e){return xe.apply(this,arguments)},exports.prepareGenericUpdate=function(t,e,r){return be.apply(this,arguments)},exports.prepareGenericUpdateEstimation=function(t,e,r){return Ie.apply(this,arguments)},exports.promiseWithTimeout=function(t,e,r){if(!t||"function"!=typeof t.then||"function"!=typeof t.catch)throw new ne;if(isNaN(e)||e<0)throw new ie;return new Promise((function(n,i){return setTimeout((function(){return i(new tt(r||"Time out"))}),e),t.then((function(t){return n(t)})).catch((function(t){return i(t)}))}))},exports.resolveIpfsCid=function(t){var e=new ae(t).ipfsCid;if(!e)throw new st;return e},exports.runAndRetry=_e,exports.strip0x=he;
//# sourceMappingURL=sdk-client-common.cjs.production.min.js.map
